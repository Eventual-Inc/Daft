

<!DOCTYPE html>


<html lang="en" data-content_root="" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Expressions &#8212; Daft API Documentation  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/header.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-function-signatures.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/expressions';</script>
    <script src="../_static/custom.js"></script>
    <link rel="canonical" href="https://www.getdaft.io/projects/docs/en/stable/user_guide/expressions.html" />
    <link rel="shortcut icon" href="../_static/daft-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YN4QSRPV0K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YN4QSRPV0K');
</script>
<script>
  (function() {
    if (typeof window === 'undefined') return;
    if (typeof window.signals !== 'undefined') return;
    var script = document.createElement('script');
    script.src = 'https://cdn.cr-relay.com/v1/site/9bf5cfb7-d3ce-4f5c-9de2-0802bea74edb/signals.js';
    script.async = true;
    window.signals = Object.assign(
      [],
      ['page', 'identify', 'form'].reduce(function (acc, method){
        acc[method] = function () {
          signals.push([method, arguments]);
          return signals;
        };
       return acc;
      }, {})
    );
    document.head.appendChild(script);
  })();
</script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none"><div class="header-container">
    <a href="/"><img class="header-logo" src="../_static/daft-logo.png" alt="Daft logo" /></a>
    <nav class="header-nav">
        <ul class="header-nav-list">
            <li class="header-nav-listitem">
                <a href="https://www.getdaft.io/#get-started">
                    Get Started
                </a>
            </li>
            <li class="header-nav-listitem">
                <a href="/projects/docs/">
                    Documentation
                </a>
            </li>
            <li class="header-nav-listitem">
                <a href="https://www.github.com/Eventual-Inc/Daft">
                    Github
                </a>
            </li>
            <li class="header-nav-listitem">
                <a href="https://blog.getdaft.io/">
                    Blog
                </a>
            </li>
            <li class="header-nav-listitem">
                <a href="https://www.getdaft.io/#community">
                    Community
                </a>
            </li>
        </ul>
    </nav>
    <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
</div>
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Daft API Documentation  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_docs/index.html">API Documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_docs/index.html">Table of Contents</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_docs/creation.html">Dataframe Creation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_pylist.html">daft.from_pylist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_pydict.html">daft.from_pydict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_arrow.html">daft.from_arrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_pandas.html">daft.from_pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_parquet.html">daft.read_parquet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_csv.html">daft.read_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_json.html">daft.read_json</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_glob_path.html">daft.from_glob_path</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_iceberg.html">daft.read_iceberg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_deltalake.html">daft.read_deltalake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_hudi.html">daft.read_hudi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_ray_dataset.html">daft.from_ray_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.from_dask_dataframe.html">daft.from_dask_dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_sql.html">daft.read_sql</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_functions/daft.read_lance.html">daft.read_lance</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_docs/dataframe.html">DataFrame</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.html">daft.DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.__getitem__.html">daft.DataFrame.__getitem__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.select.html">daft.DataFrame.select</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.with_column.html">daft.DataFrame.with_column</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.with_columns.html">daft.DataFrame.with_columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.pivot.html">daft.DataFrame.pivot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.exclude.html">daft.DataFrame.exclude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.explode.html">daft.DataFrame.explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.unpivot.html">daft.DataFrame.unpivot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.melt.html">daft.DataFrame.melt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.transform.html">daft.DataFrame.transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.distinct.html">daft.DataFrame.distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.filter.html">daft.DataFrame.filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.where.html">daft.DataFrame.where</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.limit.html">daft.DataFrame.limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.sample.html">daft.DataFrame.sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.sort.html">daft.DataFrame.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.repartition.html">daft.DataFrame.repartition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.into_partitions.html">daft.DataFrame.into_partitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.join.html">daft.DataFrame.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.concat.html">daft.DataFrame.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.groupby.html">daft.DataFrame.groupby</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.sum.html">daft.DataFrame.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.mean.html">daft.DataFrame.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.stddev.html">daft.DataFrame.stddev</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.count.html">daft.DataFrame.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.min.html">daft.DataFrame.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.max.html">daft.DataFrame.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.agg.html">daft.DataFrame.agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_pydict.html">daft.DataFrame.to_pydict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_pylist.html">daft.DataFrame.to_pylist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.iter_partitions.html">daft.DataFrame.iter_partitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.iter_rows.html">daft.DataFrame.iter_rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.collect.html">daft.DataFrame.collect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.show.html">daft.DataFrame.show</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.write_parquet.html">daft.DataFrame.write_parquet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.write_csv.html">daft.DataFrame.write_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.write_iceberg.html">daft.DataFrame.write_iceberg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.write_deltalake.html">daft.DataFrame.write_deltalake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_arrow.html">daft.DataFrame.to_arrow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_pandas.html">daft.DataFrame.to_pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_torch_map_dataset.html">daft.DataFrame.to_torch_map_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_torch_iter_dataset.html">daft.DataFrame.to_torch_iter_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_ray_dataset.html">daft.DataFrame.to_ray_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.to_dask_dataframe.html">daft.DataFrame.to_dask_dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.explain.html">daft.DataFrame.explain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.schema.html">daft.DataFrame.schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/dataframe_methods/daft.DataFrame.column_names.html">daft.DataFrame.column_names</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_docs/sql.html">SQL</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.AzureConfig.html">AzureConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.GCSConfig.html">GCSConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.HTTPConfig.html">HTTPConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.S3Config.html">S3Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.abs.html">abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.acos.html">acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.acosh.html">acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.array_to_string.html">array_to_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.asin.html">asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.asinh.html">asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.atan.html">atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.atan2.html">atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.atanh.html">atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.avg.html">avg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.capitalize.html">capitalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.ceil.html">ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.clip.html">clip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.coalesce.html">coalesce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.concat.html">concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.contains.html">contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.cos.html">cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.cot.html">cot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.count.html">count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.count_distinct.html">count_distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.count_matches.html">count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.date.html">date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.day.html">day</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.dayofweek.html">dayofweek</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.degrees.html">degrees</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.ends_with.html">ends_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.exp.html">exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.explode.html">explode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.fill_nan.html">fill_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.find.html">find</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.floor.html">floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.hash.html">hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.hour.html">hour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.image_crop.html">image_crop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.image_decode.html">image_decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.image_encode.html">image_encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.image_resize.html">image_resize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.image_to_mode.html">image_to_mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.is_inf.html">is_inf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.is_nan.html">is_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.json_query.html">json_query</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.left.html">left</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.length.html">length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.length_bytes.html">length_bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_chunk.html">list_chunk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_count.html">list_count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_join.html">list_join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_max.html">list_max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_mean.html">list_mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_min.html">list_min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_slice.html">list_slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_sort.html">list_sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.list_sum.html">list_sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.ln.html">ln</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.log.html">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.log10.html">log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.log2.html">log2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.lower.html">lower</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.lpad.html">lpad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.lstrip.html">lstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.map_extract.html">map_extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.map_get.html">map_get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.max.html">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.mean.html">mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.min.html">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.minhash.html">minhash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.minute.html">minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.month.html">month</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.normalize.html">normalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.not_nan.html">not_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.partitioning_days.html">partitioning_days</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.partitioning_hours.html">partitioning_hours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.partitioning_iceberg_bucket.html">partitioning_iceberg_bucket</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.partitioning_iceberg_truncate.html">partitioning_iceberg_truncate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.partitioning_months.html">partitioning_months</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.partitioning_years.html">partitioning_years</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.radians.html">radians</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.regexp_extract.html">regexp_extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.regexp_extract_all.html">regexp_extract_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.regexp_match.html">regexp_match</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.regexp_replace.html">regexp_replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.regexp_split.html">regexp_split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.repeat.html">repeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.reverse.html">reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.right.html">right</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.round.html">round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.rpad.html">rpad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.rstrip.html">rstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.second.html">second</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.sign.html">sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.sin.html">sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.split.html">split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.sqrt.html">sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.starts_with.html">starts_with</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.stddev.html">stddev</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.stddev_samp.html">stddev_samp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.struct_extract.html">struct_extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.struct_get.html">struct_get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.sum.html">sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.tan.html">tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.time.html">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.to_date.html">to_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.to_datetime.html">to_datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.tokenize_decode.html">tokenize_decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.tokenize_encode.html">tokenize_encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.unnest.html">unnest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.upper.html">upper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.url_download.html">url_download</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.url_upload.html">url_upload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/sql_funcs/daft.sql._sql_funcs.year.html">year</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_docs/expressions.html">Expressions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.col.html">daft.col</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.lit.html">daft.lit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.to_struct.html">daft.to_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.alias.html">daft.Expression.alias</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.cast.html">daft.Expression.cast</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.if_else.html">daft.Expression.if_else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.is_null.html">daft.Expression.is_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.not_null.html">daft.Expression.not_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.fill_null.html">daft.Expression.fill_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.hash.html">daft.Expression.hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.apply.html">daft.Expression.apply</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__abs__.html">daft.Expression.__abs__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__add__.html">daft.Expression.__add__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__sub__.html">daft.Expression.__sub__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__mul__.html">daft.Expression.__mul__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__truediv__.html">daft.Expression.__truediv__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__mod__.html">daft.Expression.__mod__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__lshift__.html">daft.Expression.__lshift__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__rshift__.html">daft.Expression.__rshift__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.ceil.html">daft.Expression.ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.floor.html">daft.Expression.floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.sign.html">daft.Expression.sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.round.html">daft.Expression.round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.clip.html">daft.Expression.clip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.sqrt.html">daft.Expression.sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.cbrt.html">daft.Expression.cbrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.sin.html">daft.Expression.sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.cos.html">daft.Expression.cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.tan.html">daft.Expression.tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.cot.html">daft.Expression.cot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arcsin.html">daft.Expression.arcsin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arccos.html">daft.Expression.arccos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arctan.html">daft.Expression.arctan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arctan2.html">daft.Expression.arctan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arctanh.html">daft.Expression.arctanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arccosh.html">daft.Expression.arccosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.arcsinh.html">daft.Expression.arcsinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.radians.html">daft.Expression.radians</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.degrees.html">daft.Expression.degrees</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.log2.html">daft.Expression.log2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.log10.html">daft.Expression.log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.log.html">daft.Expression.log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.ln.html">daft.Expression.ln</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.exp.html">daft.Expression.exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.shift_left.html">daft.Expression.shift_left</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.shift_right.html">daft.Expression.shift_right</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__invert__.html">daft.Expression.__invert__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__and__.html">daft.Expression.__and__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__or__.html">daft.Expression.__or__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__lt__.html">daft.Expression.__lt__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__le__.html">daft.Expression.__le__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__eq__.html">daft.Expression.__eq__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.eq_null_safe.html">daft.Expression.eq_null_safe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__ne__.html">daft.Expression.__ne__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__gt__.html">daft.Expression.__gt__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.__ge__.html">daft.Expression.__ge__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.between.html">daft.Expression.between</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.is_in.html">daft.Expression.is_in</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.minhash.html">daft.Expression.minhash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.count.html">daft.Expression.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.sum.html">daft.Expression.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.mean.html">daft.Expression.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.stddev.html">daft.Expression.stddev</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.min.html">daft.Expression.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.max.html">daft.Expression.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.any_value.html">daft.Expression.any_value</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.agg_list.html">daft.Expression.agg_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.agg_concat.html">daft.Expression.agg_concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.approx_percentiles.html">daft.Expression.approx_percentiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.approx_count_distinct.html">daft.Expression.approx_count_distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.contains.html">daft.Expression.str.contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.match.html">daft.Expression.str.match</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.startswith.html">daft.Expression.str.startswith</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.endswith.html">daft.Expression.str.endswith</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.concat.html">daft.Expression.str.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.split.html">daft.Expression.str.split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.extract.html">daft.Expression.str.extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.extract_all.html">daft.Expression.str.extract_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.replace.html">daft.Expression.str.replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.length.html">daft.Expression.str.length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.length_bytes.html">daft.Expression.str.length_bytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.lower.html">daft.Expression.str.lower</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.upper.html">daft.Expression.str.upper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.lstrip.html">daft.Expression.str.lstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.rstrip.html">daft.Expression.str.rstrip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.reverse.html">daft.Expression.str.reverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.capitalize.html">daft.Expression.str.capitalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.left.html">daft.Expression.str.left</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.right.html">daft.Expression.str.right</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.find.html">daft.Expression.str.find</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.rpad.html">daft.Expression.str.rpad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.lpad.html">daft.Expression.str.lpad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.repeat.html">daft.Expression.str.repeat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.like.html">daft.Expression.str.like</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.ilike.html">daft.Expression.str.ilike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.substr.html">daft.Expression.str.substr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.to_date.html">daft.Expression.str.to_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.to_datetime.html">daft.Expression.str.to_datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.normalize.html">daft.Expression.str.normalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.tokenize_encode.html">daft.Expression.str.tokenize_encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.tokenize_decode.html">daft.Expression.str.tokenize_decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.str.count_matches.html">daft.Expression.str.count_matches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.binary.concat.html">daft.Expression.binary.concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.binary.length.html">daft.Expression.binary.length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.binary.slice.html">daft.Expression.binary.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.float.is_inf.html">daft.Expression.float.is_inf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.float.is_nan.html">daft.Expression.float.is_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.float.not_nan.html">daft.Expression.float.not_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.float.fill_nan.html">daft.Expression.float.fill_nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.date.html">daft.Expression.dt.date</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.hour.html">daft.Expression.dt.hour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.minute.html">daft.Expression.dt.minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.second.html">daft.Expression.dt.second</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.time.html">daft.Expression.dt.time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.day.html">daft.Expression.dt.day</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.month.html">daft.Expression.dt.month</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.year.html">daft.Expression.dt.year</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.day_of_week.html">daft.Expression.dt.day_of_week</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.dt.truncate.html">daft.Expression.dt.truncate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.chunk.html">daft.Expression.list.chunk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.count.html">daft.Expression.list.count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.get.html">daft.Expression.list.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.join.html">daft.Expression.list.join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.length.html">daft.Expression.list.length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.max.html">daft.Expression.list.max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.mean.html">daft.Expression.list.mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.min.html">daft.Expression.list.min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.slice.html">daft.Expression.list.slice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.sort.html">daft.Expression.list.sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.sum.html">daft.Expression.list.sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.list.value_counts.html">daft.Expression.list.value_counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.struct.get.html">daft.Expression.struct.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.map.get.html">daft.Expression.map.get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.image.decode.html">daft.Expression.image.decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.image.encode.html">daft.Expression.image.encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.image.resize.html">daft.Expression.image.resize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.image.crop.html">daft.Expression.image.crop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.image.to_mode.html">daft.Expression.image.to_mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.partitioning.days.html">daft.Expression.partitioning.days</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.partitioning.hours.html">daft.Expression.partitioning.hours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.partitioning.months.html">daft.Expression.partitioning.months</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.partitioning.years.html">daft.Expression.partitioning.years</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.partitioning.iceberg_bucket.html">daft.Expression.partitioning.iceberg_bucket</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.partitioning.iceberg_truncate.html">daft.Expression.partitioning.iceberg_truncate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.url.download.html">daft.Expression.url.download</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.json.query.html">daft.Expression.json.query</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.Expression.embedding.cosine_distance.html">daft.Expression.embedding.cosine_distance</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../api_docs/schema.html">Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_docs/datatype.html">DataTypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_docs/groupby.html">GroupBy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_docs/udf.html">User Defined Functions (UDFs)</a></li>


<li class="toctree-l2"><a class="reference internal" href="../api_docs/series.html">Series</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_docs/configs.html">Configuration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/configuration_functions/daft.context.set_runner_py.html">daft.context.set_runner_py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/configuration_functions/daft.context.set_runner_ray.html">daft.context.set_runner_ray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/configuration_functions/daft.set_planning_config.html">daft.set_planning_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/configuration_functions/daft.planning_config_ctx.html">daft.planning_config_ctx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/configuration_functions/daft.set_execution_config.html">daft.set_execution_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/configuration_functions/daft.execution_config_ctx.html">daft.execution_config_ctx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_configs/daft.io.IOConfig.html">daft.io.IOConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_configs/daft.io.S3Config.html">daft.io.S3Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_configs/daft.io.S3Credentials.html">daft.io.S3Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_configs/daft.io.GCSConfig.html">daft.io.GCSConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/io_configs/daft.io.AzureConfig.html">daft.io.AzureConfig</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_docs/misc.html">Miscellaneous</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/misc/daft.ImageMode.html">daft.ImageMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_docs/doc_gen/misc/daft.ImageFormat.html">daft.ImageFormat</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        


<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/user_guide/expressions.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Expressions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-expressions">Creating Expressions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#referring-to-a-column-in-a-dataframe">Referring to a column in a DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-sql">Using SQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#literals">Literals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wildcard-expressions">Wildcard Expressions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composing-expressions">Composing Expressions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numeric-expressions">Numeric Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#string-expressions">String Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#url-expressions">URL Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#json-expressions">JSON Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-expressions">Logical Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparisons">Comparisons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#if-else-pattern">If Else Pattern</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-expressions">Temporal Expressions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-temporal-operations">Basic Temporal Operations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-component-extraction">Temporal Component Extraction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-zone-operations">Time Zone Operations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-truncation">Temporal Truncation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="expressions">
<h1>Expressions<a class="headerlink" href="#expressions" title="Permalink to this heading">#</a></h1>
<p>Expressions are how you can express computations that should be run over columns of data.</p>
<section id="creating-expressions">
<h2>Creating Expressions<a class="headerlink" href="#creating-expressions" title="Permalink to this heading">#</a></h2>
<section id="referring-to-a-column-in-a-dataframe">
<h3>Referring to a column in a DataFrame<a class="headerlink" href="#referring-to-a-column-in-a-dataframe" title="Permalink to this heading">#</a></h3>
<p>Most commonly you will be creating expressions by using the <a class="reference internal" href="../api_docs/doc_gen/expression_methods/daft.col.html#daft.col" title="daft.col"><code class="xref py py-func docutils literal notranslate"><span class="pre">daft.col()</span></code></a> function.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-0-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-0-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-0-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Refers to column &quot;A&quot;</span>
<span class="n">daft</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">daft</span><span class="o">.</span><span class="n">sql_expr</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>col(A)
</pre></div>
</div>
</div>
<p>The above code creates an Expression that refers to a column named <code class="docutils literal notranslate"><span class="pre">&quot;A&quot;</span></code>.</p>
</section>
<section id="using-sql">
<h3>Using SQL<a class="headerlink" href="#using-sql" title="Permalink to this heading">#</a></h3>
<p>Daft can also parse valid SQL as expressions.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-4pqZ77iPIFNRTA==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="0">⚙️ SQL</button></div><div aria-labelledby="tab-1-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" id="panel-1-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">daft</span><span class="o">.</span><span class="n">sql_expr</span><span class="p">(</span><span class="s2">&quot;A + 1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>col(A) + lit(1)
</pre></div>
</div>
</div>
<p>The above code will create an expression representing “the column named ‘x’ incremented by 1”. For many APIs, sql_expr will actually be applied for you as syntactic sugar!</p>
</section>
<section id="literals">
<h3>Literals<a class="headerlink" href="#literals" title="Permalink to this heading">#</a></h3>
<p>You may find yourself needing to hardcode a “single value” oftentimes as an expression. Daft provides a <code class="xref py py-func docutils literal notranslate"><span class="pre">lit()</span></code> helper to do so:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-2-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-2-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-2-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">daft</span><span class="w"> </span><span class="kn">import</span> <span class="n">lit</span>

<span class="c1"># Refers to an expression which always evaluates to 42</span>
<span class="n">lit</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Refers to an expression which always evaluates to 42</span>
<span class="n">daft</span><span class="o">.</span><span class="n">sql_expr</span><span class="p">(</span><span class="s2">&quot;42&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>lit(42)
</pre></div>
</div>
</div>
<p>This special <code class="xref py py-func docutils literal notranslate"><span class="pre">lit()</span></code> expression we just created evaluates always to the value <code class="docutils literal notranslate"><span class="pre">42</span></code>.</p>
</section>
<section id="wildcard-expressions">
<h3>Wildcard Expressions<a class="headerlink" href="#wildcard-expressions" title="Permalink to this heading">#</a></h3>
<p>You can create expressions on multiple columns at once using a wildcard. The expression <code class="xref py py-obj docutils literal notranslate"><span class="pre">col(&quot;*&quot;)</span></code> selects every column in a DataFrame, and you can operate on this expression in the same way as a single column:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button></div><div aria-labelledby="tab-3-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-3-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">daft</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">daft</span><span class="w"> </span><span class="kn">import</span> <span class="n">col</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────┬───────╮
│ A     ┆ B     │
│ ---   ┆ ---   │
│ Int64 ┆ Int64 │
╞═══════╪═══════╡
│ 3     ┆ 12    │
├╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┤
│ 6     ┆ 15    │
├╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┤
│ 9     ┆ 18    │
╰───────┴───────╯
</pre></div>
</div>
</div>
<p>Wildcards also work very well for accessing all members of a struct column:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-4-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-4-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-4-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">daft</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">daft</span><span class="w"> </span><span class="kn">import</span> <span class="n">col</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;person&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Access all fields of the &#39;person&#39; struct</span>
<span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;person.*&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">daft</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;person&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">}</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Access all fields of the &#39;person&#39; struct using SQL</span>
<span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT person.* FROM df&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭──────────┬───────╮
│ name     ┆ age   │
│ ---      ┆ ---   │
│ String   ┆ Int64 │
╞══════════╪═══════╡
│ Alice    ┆ 30    │
├╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┤
│ Bob      ┆ 25    │
├╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┤
│ Charlie  ┆ 35    │
╰──────────┴───────╯
</pre></div>
</div>
</div>
<p>In this example, we use the wildcard <code class="xref py py-obj docutils literal notranslate"><span class="pre">*</span></code> to access all fields of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">person</span></code> struct column. This is equivalent to selecting each field individually (<code class="xref py py-obj docutils literal notranslate"><span class="pre">person.name</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">person.age</span></code>), but is more concise and flexible, especially when dealing with structs that have many fields.</p>
</section>
</section>
<section id="composing-expressions">
<h2>Composing Expressions<a class="headerlink" href="#composing-expressions" title="Permalink to this heading">#</a></h2>
<section id="numeric-expressions">
<span id="userguide-numeric-expressions"></span><h3>Numeric Expressions<a class="headerlink" href="#numeric-expressions" title="Permalink to this heading">#</a></h3>
<p>Since column “A” is an integer, we can run numeric computation such as addition, division and checking its value. Here are some examples where we create new columns using the results of such computations:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-5-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-5-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-5-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add 1 to each element in column &quot;A&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;A_add_one&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Divide each element in column A by 2</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;A_divide_two&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>

<span class="c1"># Check if each element in column A is more than 1</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;A_gt_1&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        *,</span>
<span class="s2">        A + 1 AS A_add_one,</span>
<span class="s2">        A / 2.0 AS A_divide_two,</span>
<span class="s2">        A &gt; 1 AS A_gt_1</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id6" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+---------+-------------+----------------+-----------+
|       A |   A_add_one |   A_divide_two | A_gt_1    |
|   Int64 |       Int64 |        Float64 | Boolean   |
+=========+=============+================+===========+
|       1 |           2 |            0.5 | false     |
+---------+-------------+----------------+-----------+
|       2 |           3 |            1   | true      |
+---------+-------------+----------------+-----------+
|       3 |           4 |            1.5 | true      |
+---------+-------------+----------------+-----------+
(Showing first 3 of 3 rows)
</pre></div>
</div>
</div>
<p>Notice that the returned types of these operations are also well-typed according to their input types. For example, calling <code class="docutils literal notranslate"><span class="pre">df[&quot;A&quot;]</span> <span class="pre">&gt;</span> <span class="pre">1</span></code> returns a column of type <code class="xref py py-meth docutils literal notranslate"><span class="pre">Boolean</span></code>.</p>
<p>Both the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Float</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Int</span></code> types are numeric types, and inherit many of the same arithmetic Expression operations. You may find the full list of numeric operations in the <a class="reference internal" href="../api_docs/expressions.html#api-numeric-expression-operations"><span class="std std-ref">Expressions API reference</span></a>.</p>
</section>
<section id="string-expressions">
<span id="userguide-string-expressions"></span><h3>String Expressions<a class="headerlink" href="#string-expressions" title="Permalink to this heading">#</a></h3>
<p>Daft also lets you have columns of strings in a DataFrame. Let’s take a look!</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-6-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button></div><div aria-labelledby="tab-6-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-6-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">]})</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+--------+
| B      |
| Utf8   |
+========+
| foo    |
+--------+
| bar    |
+--------+
| baz    |
+--------+
(Showing first 3 rows)
</pre></div>
</div>
</div>
<p>Unlike the numeric types, the string type does not support arithmetic operations such as <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">/</span></code>. The one exception to this is the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator, which is overridden to concatenate two string expressions as is commonly done in Python. Let’s try that!</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-7-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-7-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-7-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-7-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT *, B + &#39;foo&#39; AS B2 FROM df&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+--------+--------+
| B      | B2     |
| Utf8   | Utf8   |
+========+========+
| foo    | foofoo |
+--------+--------+
| bar    | barfoo |
+--------+--------+
| baz    | bazfoo |
+--------+--------+
(Showing first 3 rows)
</pre></div>
</div>
</div>
<p>There are also many string operators that are accessed through a separate <code class="xref py py-meth docutils literal notranslate"><span class="pre">.str.*</span></code> “method namespace”.</p>
<p>For example, to check if each element in column “B” contains the substring “a”, we can use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">.str.contains</span></code> method:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-8-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-8-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-8-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-8-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-8-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;B2_contains_B&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]))</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-8-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT *, contains(B2, B) AS B2_contains_B FROM df&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id9" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+--------+--------+-----------------+
| B      | B2     | B2_contains_B   |
| Utf8   | Utf8   | Boolean         |
+========+========+=================+
| foo    | foofoo | true            |
+--------+--------+-----------------+
| bar    | barfoo | true            |
+--------+--------+-----------------+
| baz    | bazfoo | true            |
+--------+--------+-----------------+
(Showing first 3 rows)
</pre></div>
</div>
</div>
<p>You may find a full list of string operations in the <a class="reference internal" href="../api_docs/expressions.html#api-string-expression-operations"><span class="std std-ref">Expressions API reference</span></a>.</p>
</section>
<section id="url-expressions">
<h3>URL Expressions<a class="headerlink" href="#url-expressions" title="Permalink to this heading">#</a></h3>
<p>One special case of a String column you may find yourself working with is a column of URL strings.</p>
<p>Daft provides the <code class="xref py py-meth docutils literal notranslate"><span class="pre">.url.*</span></code> method namespace with functionality for working with URL strings. For example, to download data from URLs:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-9-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-9-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-9-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-9-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-9-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;urls&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;https://www.google.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s3://daft-public-data/open-images/validation-images/0001eeaf4aed83f9.jpg&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;urls&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">download</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-9-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;urls&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;https://www.google.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;s3://daft-public-data/open-images/validation-images/0001eeaf4aed83f9.jpg&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        urls,</span>
<span class="s2">        url_download(urls) AS data</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id10" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+----------------------+----------------------+
| urls                 | data                 |
| Utf8                 | Binary               |
+======================+======================+
| https://www.google.c | b&#39;&lt;!doctype          |
| om                   | html&gt;&lt;html           |
|                      | itemscope=&quot;&quot; itemtyp |
|                      | e=&quot;http://sche...    |
+----------------------+----------------------+
| s3://daft-public-    | b&#39;\xff\xd8\xff\xe0\x |
| data/open-           | 00\x10JFIF\x00\x01\x |
| images/validation-   | 01\x01\x00H\x00H\... |
| images/0001e...      |                      |
+----------------------+----------------------+
(Showing first 2 of 2 rows)
</pre></div>
</div>
</div>
<p>This works well for URLs which are HTTP paths to non-HTML files (e.g. jpeg), local filepaths or even paths to a file in an object store such as AWS S3 as well!</p>
</section>
<section id="json-expressions">
<h3>JSON Expressions<a class="headerlink" href="#json-expressions" title="Permalink to this heading">#</a></h3>
<p>If you have a column of JSON strings, Daft provides the <code class="xref py py-meth docutils literal notranslate"><span class="pre">.json.*</span></code> method namespace to run <a class="reference external" href="https://stedolan.github.io/jq/manual/">JQ-style filters</a> on them. For example, to extract a value from a JSON object:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-10-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-10-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-10-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-10-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-10-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2}&#39;</span><span class="p">,</span>
        <span class="s1">&#39;{&quot;a&quot;: 3, &quot;b&quot;: 4}&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;.a&quot;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-10-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;{&quot;a&quot;: 1, &quot;b&quot;: 2}&#39;</span><span class="p">,</span>
        <span class="s1">&#39;{&quot;a&quot;: 3, &quot;b&quot;: 4}&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        json,</span>
<span class="s2">        json_query(json, &#39;.a&#39;) AS a</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id11" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭──────────────────┬──────╮
│ json             ┆ a    │
│ ---              ┆ ---  │
│ Utf8             ┆ Utf8 │
╞══════════════════╪══════╡
│ {&quot;a&quot;: 1, &quot;b&quot;: 2} ┆ 1    │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌┤
│ {&quot;a&quot;: 3, &quot;b&quot;: 4} ┆ 3    │
╰──────────────────┴──────╯

(Showing first 2 of 2 rows)
</pre></div>
</div>
</div>
<p>Daft uses <a class="reference external" href="https://github.com/01mf02/jaq/tree/main">jaq</a> as the underlying executor, so you can find the full list of supported filters in the <a class="reference external" href="https://github.com/01mf02/jaq/tree/main">jaq documentation</a>.</p>
</section>
<section id="logical-expressions">
<span id="userguide-logical-expressions"></span><h3>Logical Expressions<a class="headerlink" href="#logical-expressions" title="Permalink to this heading">#</a></h3>
<p>Logical Expressions are an expression that refers to a column of type <code class="xref py py-meth docutils literal notranslate"><span class="pre">Boolean</span></code>, and can only take on the values True or False.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-11-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button></div><div aria-labelledby="tab-11-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-11-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]})</span>
</pre></div>
</div>
</div></div>
<p>Daft supports logical operations such as <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (and) and <code class="docutils literal notranslate"><span class="pre">|</span></code> (or) between logical expressions.</p>
</section>
<section id="comparisons">
<h3>Comparisons<a class="headerlink" href="#comparisons" title="Permalink to this heading">#</a></h3>
<p>Many of the types in Daft support comparisons between expressions that returns a Logical Expression.</p>
<p>For example, here we can compare if each element in column “A” is equal to elements in column “B”:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-12-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-12-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-12-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-12-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-12-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;A_eq_B&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-12-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        A,</span>
<span class="s2">        B,</span>
<span class="s2">        A = B AS A_eq_B</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id12" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────┬───────┬─────────╮
│ A     ┆ B     ┆ A_eq_B  │
│ ---   ┆ ---   ┆ ---     │
│ Int64 ┆ Int64 ┆ Boolean │
╞═══════╪═══════╪═════════╡
│ 1     ┆ 1     ┆ true    │
├╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤
│ 2     ┆ 2     ┆ true    │
├╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤
│ 3     ┆ 4     ┆ false   │
╰───────┴───────┴─────────╯

(Showing first 3 of 3 rows)
</pre></div>
</div>
</div>
<p>Other useful comparisons can be found in the <a class="reference internal" href="../api_docs/expressions.html#api-comparison-expression"><span class="std std-ref">Expressions API reference</span></a>.</p>
</section>
<section id="if-else-pattern">
<h3>If Else Pattern<a class="headerlink" href="#if-else-pattern" title="Permalink to this heading">#</a></h3>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">.if_else()</span></code> method is a useful expression to have up your sleeve for choosing values between two other expressions based on a logical expression:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-13-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-13-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-13-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-13-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-13-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="c1"># Pick values from column A if the value in column A is bigger</span>
<span class="c1"># than the value in column B. Otherwise, pick values from column B.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s2">&quot;A_if_bigger_else_B&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">if_else</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]),</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-13-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        A,</span>
<span class="s2">        B,</span>
<span class="s2">        CASE</span>
<span class="s2">            WHEN A &gt; B THEN A</span>
<span class="s2">            ELSE B</span>
<span class="s2">        END AS A_if_bigger_else_B</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id13" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────┬───────┬────────────────────╮
│ A     ┆ B     ┆ A_if_bigger_else_B │
│ ---   ┆ ---   ┆ ---                │
│ Int64 ┆ Int64 ┆ Int64              │
╞═══════╪═══════╪════════════════════╡
│ 1     ┆ 0     ┆ 1                  │
├╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2     ┆ 2     ┆ 2                  │
├╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 3     ┆ 4     ┆ 4                  │
╰───────┴───────┴────────────────────╯

(Showing first 3 of 3 rows)
</pre></div>
</div>
</div>
<p>This is a useful expression for cleaning your data!</p>
</section>
<section id="temporal-expressions">
<h3>Temporal Expressions<a class="headerlink" href="#temporal-expressions" title="Permalink to this heading">#</a></h3>
<p>Daft provides rich support for working with temporal data types like Timestamp and Duration. Let’s explore some common temporal operations:</p>
<section id="basic-temporal-operations">
<h4>Basic Temporal Operations<a class="headerlink" href="#basic-temporal-operations" title="Permalink to this heading">#</a></h4>
<p>You can perform arithmetic operations with timestamps and durations, such as adding a duration to a timestamp or calculating the duration between two timestamps:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-14-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-14-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-14-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-14-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-14-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-14-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Add 10 seconds to each timestamp</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s2">&quot;plus_10_seconds&quot;</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-14-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Add 10 seconds to each timestamp and calculate duration between timestamps</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        timestamp,</span>
<span class="s2">        timestamp + INTERVAL &#39;10 seconds&#39; as plus_10_seconds,</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id14" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────────────────────────────┬───────────────────────────────╮
│ timestamp                     ┆ plus_10_seconds               │
│ ---                           ┆ ---                           │
│ Timestamp(Microseconds, None) ┆ Timestamp(Microseconds, None) │
╞═══════════════════════════════╪═══════════════════════════════╡
│ 2021-01-01 00:01:01           ┆ 2021-01-01 00:01:11           │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2021-01-01 00:01:59           ┆ 2021-01-01 00:02:09           │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2021-01-01 00:02:00           ┆ 2021-01-01 00:02:10           │
╰───────────────────────────────┴───────────────────────────────╯
</pre></div>
</div>
</div>
</section>
<section id="temporal-component-extraction">
<h4>Temporal Component Extraction<a class="headerlink" href="#temporal-component-extraction" title="Permalink to this heading">#</a></h4>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">.dt.*</span></code> method namespace provides extraction methods for the components of a timestamp, such as year, month, day, hour, minute, and second:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-15-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-15-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-15-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-15-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-15-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-15-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Extract year, month, day, hour, minute, and second from the timestamp</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_columns</span><span class="p">({</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">(),</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">(),</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="p">(),</span>
    <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">(),</span>
    <span class="s2">&quot;minute&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">minute</span><span class="p">(),</span>
    <span class="s2">&quot;second&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">second</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-15-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Extract year, month, day, hour, minute, and second from the timestamp</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        timestamp,</span>
<span class="s2">        year(timestamp) as year,</span>
<span class="s2">        month(timestamp) as month,</span>
<span class="s2">        day(timestamp) as day,</span>
<span class="s2">        hour(timestamp) as hour,</span>
<span class="s2">        minute(timestamp) as minute,</span>
<span class="s2">        second(timestamp) as second</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id15" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────────────────────────────┬───────┬────────┬────────┬────────┬────────┬────────╮
│ timestamp                     ┆ year  ┆ month  ┆ day    ┆ hour   ┆ minute ┆ second │
│ ---                           ┆ ---   ┆ ---    ┆ ---    ┆ ---    ┆ ---    ┆ ---    │
│ Timestamp(Microseconds, None) ┆ Int32 ┆ UInt32 ┆ UInt32 ┆ UInt32 ┆ UInt32 ┆ UInt32 │
╞═══════════════════════════════╪═══════╪════════╪════════╪════════╪════════╪════════╡
│ 2021-01-01 00:01:01           ┆ 2021  ┆ 1      ┆ 1      ┆ 0      ┆ 1      ┆ 1      │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┤
│ 2021-01-01 00:01:59           ┆ 2021  ┆ 1      ┆ 1      ┆ 0      ┆ 1      ┆ 59     │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌┤
│ 2021-01-01 00:02:00           ┆ 2021  ┆ 1      ┆ 1      ┆ 0      ┆ 2      ┆ 0      │
╰───────────────────────────────┴───────┴────────┴────────┴────────┴────────┴────────╯
</pre></div>
</div>
</div>
</section>
<section id="time-zone-operations">
<h4>Time Zone Operations<a class="headerlink" href="#time-zone-operations" title="Permalink to this heading">#</a></h4>
<p>You can parse strings as timestamps with time zones and convert between different time zones:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-16-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-16-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button><button aria-controls="panel-16-4pqZ77iPIFNRTA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-16-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tab" tabindex="-1">⚙️ SQL</button></div><div aria-labelledby="tab-16-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-16-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp_str&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;2021-01-01 00:00:00.123 +0800&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2021-01-02 12:30:00.456 +0800&quot;</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Parse the timestamp string with time zone and convert to New York time</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s2">&quot;ny_time&quot;</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp_str&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
        <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S</span><span class="si">%.3f</span><span class="s2"> %z&quot;</span><span class="p">,</span>
        <span class="n">timezone</span><span class="o">=</span><span class="s2">&quot;America/New_York&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-4pqZ77iPIFNRTA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-16-4pqZ77iPIFNRTA==" name="4pqZ77iPIFNRTA==" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp_str&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;2021-01-01 00:00:00.123 +0800&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2021-01-02 12:30:00.456 +0800&quot;</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Parse the timestamp string with time zone and convert to New York time</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT</span>
<span class="s2">        timestamp_str,</span>
<span class="s2">        to_datetime(timestamp_str, &#39;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S</span><span class="si">%.3f</span><span class="s2"> %z&#39;, &#39;America/New_York&#39;) as ny_time</span>
<span class="s2">    FROM df</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id16" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────────────────────────────┬───────────────────────────────────────────────────╮
│ timestamp_str                 ┆ ny_time                                           │
│ ---                           ┆ ---                                               │
│ Utf8                          ┆ Timestamp(Milliseconds, Some(&quot;America/New_York&quot;)) │
╞═══════════════════════════════╪═══════════════════════════════════════════════════╡
│ 2021-01-01 00:00:00.123 +0800 ┆ 2020-12-31 11:00:00.123 EST                       │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2021-01-02 12:30:00.456 +0800 ┆ 2021-01-01 23:30:00.456 EST                       │
╰───────────────────────────────┴───────────────────────────────────────────────────╯
</pre></div>
</div>
</div>
</section>
<section id="temporal-truncation">
<h4>Temporal Truncation<a class="headerlink" href="#temporal-truncation" title="Permalink to this heading">#</a></h4>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">.dt.truncate()</span></code> method allows you to truncate timestamps to specific time units. This can be useful for grouping data by time periods.
For example, to truncate timestamps to the nearest hour:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-17-8J+QjSBQeXRob24=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-17-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tab" tabindex="0">🐍 Python</button></div><div aria-labelledby="tab-17-8J+QjSBQeXRob24=" class="sphinx-tabs-panel group-tab" id="panel-17-8J+QjSBQeXRob24=" name="8J+QjSBQeXRob24=" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">from_pydict</span><span class="p">({</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Truncate timestamps to the nearest hour</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s2">&quot;hour_start&quot;</span><span class="p">,</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="s2">&quot;1 hour&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id17" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>╭───────────────────────────────┬───────────────────────────────╮
│ timestamp                     ┆ hour_start                    │
│ ---                           ┆ ---                           │
│ Timestamp(Microseconds, None) ┆ Timestamp(Microseconds, None) │
╞═══════════════════════════════╪═══════════════════════════════╡
│ 2021-01-07 00:01:01           ┆ 2021-01-07 00:00:00           │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2021-01-08 00:01:59           ┆ 2021-01-08 00:00:00           │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2021-01-09 00:30:00           ┆ 2021-01-09 00:00:00           │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2021-01-10 01:59:59           ┆ 2021-01-10 01:00:00           │
╰───────────────────────────────┴───────────────────────────────╯
</pre></div>
</div>
</div>
</section>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-expressions">Creating Expressions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#referring-to-a-column-in-a-dataframe">Referring to a column in a DataFrame</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-sql">Using SQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#literals">Literals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wildcard-expressions">Wildcard Expressions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composing-expressions">Composing Expressions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numeric-expressions">Numeric Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#string-expressions">String Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#url-expressions">URL Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#json-expressions">JSON Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-expressions">Logical Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparisons">Comparisons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#if-else-pattern">If Else Pattern</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-expressions">Temporal Expressions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-temporal-operations">Basic Temporal Operations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-component-extraction">Temporal Component Extraction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-zone-operations">Time Zone Operations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-truncation">Temporal Truncation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eventual
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Eventual.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        


<!-- Mobile menu that pops up when hamburger menu is clicked -->
<div class="mobile-main-menu">
    <div class="header-container">
        <a href="/"><img class="header-logo" src="../_static/daft-logo.png" alt="Daft logo" /></a>
        <a href="#" class="main-menu-close-button" data-behavior="close-mobile-menu"></a>
    </div>
    <ul class="header-nav-list mobile">
        <li class="header-nav-listitem mobile">
            <a href="https://www.getdaft.io/#get-started">
                Get Started
            </a>
        </li>
        <li class="header-nav-listitem mobile">
            <a href="/projects/docs/">
                Documentation
            </a>
        </li>
        <li class="header-nav-listitem mobile">
            <a href="https://www.github.com/Eventual-Inc/Daft">
                Github
            </a>
        </li>
        <li class="header-nav-listitem mobile">
            <a href="https://blog.getdaft.io/">
                Blog
            </a>
        </li>
        <li class="header-nav-listitem mobile">
            <a href="https://www.getdaft.io/#community">
                Community
            </a>
        </li>
    </ul>
</div>
<script src="../_static/mobile-menu.js"></script>
<script type="text/javascript">
    mobileMenu.bind();
</script>

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>