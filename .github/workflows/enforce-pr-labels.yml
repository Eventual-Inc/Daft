name: Enforce Pull Request Labels
on:
  pull_request:
    types: [opened, labeled, unlabeled, synchronize]
  # Runs after the Release Drafter workflow runs on a non-main branch because that may have auto-labelled the PR
  #
  # NOTE: This is required because the Release Drafter workflow uses the `github-actions` bot to label the PR,
  # and actions taken by the `github-actions` bot are not allowed to trigger new workflows.
  workflow_run:
    workflows:
    - Release Drafter
    types:
    - completed
    branches-ignore:
    - main
jobs:
  label:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
    - uses: mheap/github-action-required-labels@v5
      with:
        mode: minimum
        count: 1
        labels: performance, enhancement, bug, chore, documentation, dependencies
        add_comment: true
        message: |
          This PR is being prevented from merging because you need at least one of the required labels:

          ```
          enhancement | performance | bug | chore | documentation | dependencies
          ```

          The canonical and easiest way of adding them is to add the following prefixes to your PR title:

          * [FEAT]: adds the `enhancement` label
          * [PERF]: adds the `performance` label
          * [BUG]: adds the `bug` label
          * [CHORE]: adds the `chore` label
          * [DOCS]: adds the `documentation` label

          Thanks for helping us categorize and manage our PRs!
