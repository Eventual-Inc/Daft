apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
bases:
- ../../components
- ../../components/cloudwatch
- ../../components/frontend
patchesStrategicMerge:
- use_prod_images.yaml
- use_jupyterhub_db.yaml
- backend_env.yaml
- cloudwatch/cwagent/rbac.yaml
- cloudwatch/fluent-bit/rbac.yaml
patchesJson6902:
- path: use_loadbalancer_traefik_service.yaml
  target:
    version: v1
    kind: Service
    name: eventual-hub-proxy-external
- path: use_prod_frontend_certificate.yaml
  target:
    version: v1
    kind: Service
    name: frontend-svc
secretGenerator:
- name: eventual-hub
  envs:
  - .env.prod-auth0.secret
configMapGenerator:
- name: cwagentconfig
  namespace: amazon-cloudwatch
  behavior: merge
  files:
  - cloudwatch/cwagent/cwagentconfig.json
- name: fluent-bit-cluster-info
  namespace: amazon-cloudwatch
  behavior: merge
  literals:
  - cluster.name=prod-cluster
  - logs.region=us-west-2
